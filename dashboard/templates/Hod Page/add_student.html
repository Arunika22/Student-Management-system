{% block page_title %}
{% endblock page_title %}

{% block main_content %}

{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hod Page</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <script src="{% static 'script.js' %}" type="text/javascript"></script>
</head>

<body>
    <header>
        <div>
            <a href="/">
                <div class="logo">
                    <i class="fa-solid fa-user-tie"></i>
                    HODAccount
                </div>
            </a>
        </div>

        {% include '../headerUser.html' %}

    </header>

    <div id="main">

        {% include './navigation.html' %}


        <div class="form hamburger">
            <h2>Add Student</h2>
            {% comment %}
            <form action="{% url 'add_student_save'%}" method="post">
                <div class="form-field">
                    <label for="student_id">Student Id</label>
                    <input type="text" name="student_id" id="student_id" placeholder="Enter Student Id">
                </div>
                <div class="form-field">
                    <label for="student_name">Student Name</label>
                    <input type="text" name="student_name" id="student_name" placeholder="Enter Full Name">
                </div>
                <div class="form-field">
                    <label for="department">Department</label>
                    <select name="department" id="department" required>
                        <option disabled selected>
                            -- Choose --
                        </option>
                        <option value="CSE">
                            CSE
                        </option>
                        <option value="ECE">
                            ECE
                        </option>
                        <option value="Civil">
                            Civil
                        </option>
                        <option value="ME">
                            ME
                        </option>
                        <option value="EE">
                            EE
                        </option>
                        <option value="AI">
                            AI
                        </option>

                    </select>
                </div>
                <div class="form-field">
                    <label for="semester">Semester</label>
                    <input type="number" name="semester" id="semester" placeholder="Enter Semester">
                </div>
                <div class="form-field">
                    <label for="cgpa">Cgpa</label>
                    <input type="number" name="cgpa" id="cgpa" placeholder="Enter Cgpa">
                </div>
                <div class="form-field">
                    <button type="submit">Add Student</button>
                </div>
            </form>
            {% endcomment %}
            {% url 'add_student_save' as action_path %}
            {% include 'Hod Page/form_template.html' with form=form action_path=action_path button_text="Add Student" %}
        </div>
    </div>

</body>

</html>

{% endblock main_content %}
{% block custom_js %}
{% comment %} Checking if email and username already exists or not usin Ajax {% endcomment %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>

    $(document).ready(function () {
        // keyup event will be triggered when user leaves keyboard
        $("#id_email").keyup(function () {
            var email = $(this).val();

            if (email != "") {
                $.ajax({
                    url: '{% url 'check_email_exist' %}',
                    type: 'POST',
                    data: { email: email }
                })
                    .done(function (response) {
                        //console.log(response);

                        if (response == "True") {
                            $(".email_error").remove();
                            $("<span class='email_error' style='color: red; padding: 5px; font-weight: bold;'> Email Not Available. </span>").insertAfter("#id_email")
                        }
                        else {
                            $(".email_error").remove();
                            $("<span class='email_error' style='color: green; padding: 5px; font-weight: bold;'> Email Available. </span>").insertAfter("#id_email")
                        }
                    })

                    .fail(function () {
                        console.log("Failed");
                    })
            }
            else {
                $(".email_error").remove();
            }

        })

        $("#id_username").keyup(function () {
            var username = $(this).val();

            if (username != "") {
                $.ajax({
                    url: '{% url 'check_username_exist' %}',
                    type: 'POST',
                    data: { username: username }
                })
                    .done(function (response) {
                        //console.log(response);

                        if (response == "True") {
                            $(".username_error").remove();
                            $("<span class='username_error' style='color: red; padding: 5px; font-weight: bold;'> Username Not Available. </span>").insertAfter("#id_username")
                        }
                        else {
                            $(".username_error").remove();
                            $("<span class='username_error' style='color: green; padding: 5px; font-weight: bold;'> Username Available. </span>").insertAfter("#id_username")
                        }
                    })

                    .fail(function () {
                        console.log("Failed");
                    })
            }
            else {
                $(".username_error").remove();
            }

        })
    })
</script>

{% endblock custom_js %}